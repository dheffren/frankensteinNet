#TODO: Add loss functions and regularization terms. Implement in config. 